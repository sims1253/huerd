<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate Optimal Color Palette using Pure Minimax Optimization — generate_palette • huerd</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Optimal Color Palette using Pure Minimax Optimization — generate_palette"><meta property="og:description" content="Creates a scientifically-grounded color palette that maximizes the minimum
perceptual distance between any two colors using pure minimax optimization in
the OKLAB color space. Colors are automatically sorted by brightness and can
include fixed brand colors."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">huerd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction-to-huerd.html">Introduction to huerd</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sims1253/huerd/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate Optimal Color Palette using Pure Minimax Optimization</h1>
    <small class="dont-index">Source: <a href="https://github.com/sims1253/huerd/blob/sims/dev/R/generate_palette.R" class="external-link"><code>R/generate_palette.R</code></a></small>
    <div class="hidden name"><code>generate_palette.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a scientifically-grounded color palette that maximizes the minimum
perceptual distance between any two colors using pure minimax optimization in
the OKLAB color space. Colors are automatically sorted by brightness and can
include fixed brand colors.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_palette</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  include_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k-means++"</span>, <span class="st">"harmony"</span><span class="op">)</span>,</span>
<span>  init_lightness_bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>  init_hcl_bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span>, L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  fixed_aesthetic_influence <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  aesthetic_init_config <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  return_metrics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progress <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimizer <span class="op">=</span> <span class="st">"nloptr_cobyla"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer. Total number of colors in the palette.</p></dd>


<dt id="arg-include-colors">include_colors<a class="anchor" aria-label="anchor" href="#arg-include-colors"></a></dt>
<dd><p>Character vector. Hex colors that must be included
in the palette unchanged. Default is NULL.</p></dd>


<dt id="arg-initialization">initialization<a class="anchor" aria-label="anchor" href="#arg-initialization"></a></dt>
<dd><p>Character. Initialization method for free colors:
"k-means++" or "harmony". Default is "k-means++".</p></dd>


<dt id="arg-init-lightness-bounds">init_lightness_bounds<a class="anchor" aria-label="anchor" href="#arg-init-lightness-bounds"></a></dt>
<dd><p>Numeric vector of length 2. For k-means++ initialization,
target lightness (L in OKLAB) range for initial candidates. Default <code>c(0.2, 0.9)</code>.</p></dd>


<dt id="arg-init-hcl-bounds">init_hcl_bounds<a class="anchor" aria-label="anchor" href="#arg-init-hcl-bounds"></a></dt>
<dd><p>List. For harmony-based initialization, target
<code>C</code> (Chroma) and <code>L</code> (Luminance) ranges for initial HCL colors.
Default <code>list(C = c(40, 80), L = c(50, 80))</code>.</p></dd>


<dt id="arg-fixed-aesthetic-influence">fixed_aesthetic_influence<a class="anchor" aria-label="anchor" href="#arg-fixed-aesthetic-influence"></a></dt>
<dd><p>Numeric, 0 to 1. If <code>include_colors</code> are provided,
controls how strongly their aesthetic properties influence the initialization
for free colors. 0 = no influence, 1 = strong influence. Default is 0.75.</p></dd>


<dt id="arg-aesthetic-init-config">aesthetic_init_config<a class="anchor" aria-label="anchor" href="#arg-aesthetic-init-config"></a></dt>
<dd><p>List. Advanced configuration for aesthetic initialization.
Use <code>NULL</code> (default) for built-in defaults.</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Integer. Maximum optimization iterations. Default is 1000.</p></dd>


<dt id="arg-return-metrics">return_metrics<a class="anchor" aria-label="anchor" href="#arg-return-metrics"></a></dt>
<dd><p>Logical. Whether to return evaluation metrics as
attributes. Default is TRUE.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical. Show progress messages. Default is <code><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive()</a></code>.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Named numeric vector. Weights for multi-objective optimization.
Currently only supports <code>c(distance = 1)</code> for distance-based optimization.
Default is NULL (equivalent to pure distance optimization).</p></dd>


<dt id="arg-optimizer">optimizer<a class="anchor" aria-label="anchor" href="#arg-optimizer"></a></dt>
<dd><p>Character. Optimization algorithm to use. Currently supported:
"nloptr_cobyla" (default) for deterministic optimization with constraint handling,
"sann" for stochastic simulated annealing (excellent quality but not perfectly
reproducible without a seed), "nlopt_direct" for deterministic global optimization
using the DIRECT algorithm (best choice for scientific reproducibility and high
quality, though may be slower), "nlopt_neldermead" for derivative-free local
optimization using the Nelder-Mead simplex algorithm (good alternative to COBYLA
for robust local optimization). The framework is designed to easily support
additional optimizers in future versions.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A character vector of hex colors with class <code>huerd_palette</code>, automatically
sorted by brightness (lightness). If <code>return_metrics = TRUE</code>, includes evaluation
metrics as attributes.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function implements pure minimax optimization to create color palettes with
maximum worst-case perceptual distinguishability. The approach is scientifically
grounded and focuses on a single, clear objective.</p>
<p>The process:</p><ol><li><p>Initialize free colors using k-means++ or harmony-based methods</p></li>
<li><p>Optimize using box-constrained nloptr to maximize minimum perceptual distance</p></li>
<li><p>Sort final palette by OKLAB lightness for intuitive ordering</p></li>
<li><p>Apply gamut compensation during brightness sorting</p></li>
</ol><p>The pure minimax approach ensures optimal categorical color palettes without
complex multi-objective trade-offs. Quality can be assessed using <code><a href="evaluate_palette.html">evaluate_palette()</a></code>
and visualized with <code><a href="plot_palette_analysis.html">plot_palette_analysis()</a></code>.</p>
    </div>
    <div id="performance-tips">
    <h2>Performance Tips</h2>


<ul><li><p>For low performance ratios, try increasing <code>max_iterations</code></p></li>
<li><p>Use <code>progress = TRUE</code> to monitor optimization convergence</p></li>
<li><p>Include 2-3 fixed colors maximum for best optimization</p></li>
<li><p>Use diagnostic dashboard <code><a href="plot_palette_analysis.html">plot_palette_analysis()</a></code> for analysis</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simple optimal palette</span></span></span>
<span class="r-in"><span><span class="va">palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span><span class="fl">5</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">palette</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- huerd Color Palette (5 colors) --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Colors:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 1] #002E00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 2] #0038CF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 3] #FF0076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 4] #F8A300</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ 5] #ACFFBF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Quality Metrics Summary --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Min. Perceptual Distance (OKLAB): 0.238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Optimizer Performance Ratio      : 57.9%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Min. CVD-Safe Distance (OKLAB)  : 0.177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -- Generation Details --</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Optimizer Iterations: 456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Optimizer Status: NLOPT_XTOL_REACHED: Optimization stopped because xtol_rel or xtol_abs (above) was reached.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Brand-constrained palette</span></span></span>
<span class="r-in"><span><span class="va">brand_palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  include_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#4A6B8A"</span>, <span class="st">"#E5A04C"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using specific optimizer (deterministic)</span></span></span>
<span class="r-in"><span><span class="va">optimizer_palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"nloptr_cobyla"</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using simulated annealing (stochastic, excellent quality)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span></span>
<span class="r-in"><span><span class="va">sann_palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"sann"</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using DIRECT algorithm (deterministic global, best for scientific reproducibility)</span></span></span>
<span class="r-in"><span><span class="va">direct_palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"nlopt_direct"</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using Nelder-Mead algorithm (derivative-free local, good alternative to COBYLA)</span></span></span>
<span class="r-in"><span><span class="va">neldermead_palette</span> <span class="op">&lt;-</span> <span class="fu">generate_palette</span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  optimizer <span class="op">=</span> <span class="st">"nlopt_neldermead"</span>,</span></span>
<span class="r-in"><span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Evaluate quality</span></span></span>
<span class="r-in"><span><span class="va">evaluation</span> <span class="op">&lt;-</span> <span class="fu"><a href="evaluate_palette.html">evaluate_palette</a></span><span class="op">(</span><span class="va">brand_palette</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Min distance:"</span>, <span class="va">evaluation</span><span class="op">$</span><span class="va">distances</span><span class="op">$</span><span class="va">min</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min distance: 0.182684 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Performance:"</span>, <span class="va">evaluation</span><span class="op">$</span><span class="va">distances</span><span class="op">$</span><span class="va">performance_ratio</span> <span class="op">*</span> <span class="fl">100</span>, <span class="st">"%\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Performance: 49.9774 %</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comprehensive analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_palette_analysis.html">plot_palette_analysis</a></span><span class="op">(</span><span class="va">brand_palette</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="generate_palette-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maximilian Scholz.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

